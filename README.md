# Что это
Код графического приложения на PyQT, реализующий концепцию формирования и ведения дивидендного портфеля на рынке российских ценных бумаг. Детально заложенные идеи изложены в Презентация идеи.pptx.

В графическом ПО три основных окна:
- Окно с текущим портфелем акций
- Окно с эффективным портфелем акций, максимазированным по коэффициенту Шарпа
- Окно с графиком эффективной кривой и точкой волатильность/доходность текущего портфеля акций

В первом окне добавление акции происходит путём нажатия правой кнопкой мыши и ввода тикера акции, например, для Сбербанка - SBER. Затем автоматизировано производится скачивание информации об акции с MOEX и SmartLab, что позволяет вычислить представленные в Презентация идеи.pptx параметры. В результате для каждой акции вычисляется её оценка, а на основе оценки в последних столбцах приводится кол-во лотов и реальные веса в портфеле. Также под портфелем указывается минимальная рекомендованная сумма для портфеля. Например, для портфеля из одной акции:
![image](https://github.com/user-attachments/assets/bab3708d-b751-4de8-b541-7d68c206cb25)

А уже для двух:
![image](https://github.com/user-attachments/assets/d6846e5f-9db6-4bf1-9298-2a9d924bbe65)

В поле "Сумма" можно ввести произвольную сумму для портфеля и нажать кнопку "Ребалансировать". Для этой суммы будет произведен перерасчёт кол-ва лотов, необходимых к приобретению, чтобы реальные веса максимально соответствовали теоретическим, например:

![image](https://github.com/user-attachments/assets/9f089c2f-3ad6-4490-9cb8-3cca646651de)
При этом будет вычислена новая доходность и волатильность портфеля, на основе которых на графике снизу перерисуется точка волатильности/доходности текущего портфеля акций. Отдельно увидеть доходность и волатильность акций можно, нажав "Файл" -> "Доходность и волатильность портфеля":
![image](https://github.com/user-attachments/assets/d0488b39-16d1-4e6a-994f-03f6bcb28b32)
![image](https://github.com/user-attachments/assets/f16896a9-de50-4295-9db2-5e813668d554)
Полученный портфель можно сохранить через "Файл" -> "Сохранить в файл", получив на выходе Excel для дальнейшего анализа и манипуляций:
![image](https://github.com/user-attachments/assets/2892ce5c-3089-48b4-800d-681ed5c43f2a)
Из этого же файла в дальнейшем портфель можно открыть через "Файл" -> "Открыть из файла", но стоит учесть, что все параметры будут вычисляться заново на текущую дату.

**Код работает в рамках Proof-of-concept, поэтому в некоторых модулях он дублируется, что приводит к долгой работе программы.**
# Как установить и запустить
Можно запустить файл из Release. Для запуска из исходных кодов на Windows 10 необходимо:
1. Установить Python 3.10 и новее
2. Установить зависимости через: `python -m pip install -r requirements.txt`
3. Запустить через `python main.py`

# Как использовать
**Добавление акций** производится путём нажатия правой кнопкой мыши, "Добавить акцию" и ввода тикера акции, например, для Сбербанка - SBER.
**Удаление акций** производится путём нажатия правой кнопкой мыши, "Удалить акцию" и ввода тикера акции, например, для Сбербанка - SBER.
**Сохранение портфеля** производится путём нажатия "Файл" -> "Сохранить в файл" и выбор пути и имени файла Excel.
**Открытие портфеля** произвоидтся путём нажатия "Файл" -> "Открыть из файла" и выбора файла Excel с ранее сохраненным портфелем.
**Вывод доходности** и волатильности портфеля производится путём нажатия "Файл" -> "Доходность и волатильность портфеля".
